<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0" name="viewport" /><meta content="Setting up Laravel 5.0 for Openshift - Tommy Ku&#39;s Blog - Random thoughts, stories and tutorials of a web dev" name="title" /><meta content="Web developer Tommy Ku talks about his experience in work, learning and life." name="description" /><meta content="Tommy Ku" name="author" /><meta content="Setting up Laravel 5.0 for Openshift - Tommy Ku&#39;s Blog - Random thoughts, stories and tutorials of a web dev" property="og:title" /><meta content="article" property="og:type" /><meta content="/assets/images/banner.jpg" property="og:image" /><link href="/assets/images/author.jpg" rel="icon" type="image/png" /><link href="/atom.xml" rel="alternate" title="Tommy Ku&#39;s Method Stub" type="application/atom+xml" /><link href="https://webmention.tkcom.workers.dev/" rel="webmention" /><title>Setting up Laravel 5.0 for Openshift - Tommy Ku&#39;s Blog</title><link href="/style/gutenberg.css" rel="stylesheet" /><link href="/style/prism.css" rel="stylesheet" /><meta content="Nanoc 4.11.15" name="generator" /></head><body><header><h2 class="h-card"><img alt="Profile pic of Tommy Ku" class="author u-photo" src="/assets/images/author.jpg" /><span class="p-name">Tommy Ku</span>'s Blog</h2><p><i>Reading and thinking</i></p></header><nav><a href="/">Index</a><a href="https://tommyku.com">About Me</a><a href="https://angel.co/tommyku">AngelList</a><a href="https://www.linkedin.com/in/tommy-chun-kit-ku-65aba999">LinkedIn</a><a rel="me" href="https://github.com/tommyku">GitHub</a><a href="/atom.xml">Feed</a></nav><main class="h-entry" id="main"><section id="meta"><h1 class="p-name">Setting up Laravel 5.0 for Openshift</h1><i>Posted on&nbsp;<time class="dt-published" datetime="2015-02-16T00:00:00+08:00">February 16, 2015</time>&nbsp;by&nbsp;<span class="p-author">Tommy Ku</span></i><section id="old"><span class="icon">&#9888;</span><p>This post is more than 2 years old, it may contain outdated information</p></section></section><section class="e-content" id="content"><p>Earlier on Laravel 5.0 has been released, with an overhaul on directory structure, easier form validation, out of the box authentication support, introduction of middleware and more. While you can find out more from the <a href="http://laravel.com/docs/5.0/releases">release note</a>, this post explains how a new version of Laravel can be pushed onto Openshift and get running.</p>

<p>To begin with, letâ€™s grab the Laravel 5.0 release and put it on to Openshift. This is done as usual via Composer.</p>

<h4 id="installation">Installation</h4>

<pre><code class="language-bash">composer create-project laravel/laravel --prefer-dist
</code></pre>

<h4 id="configuration">Configuration</h4>

<p>I think the <code>.gitignore</code> that came with this installation is not as good as before for the lack of ignoring files like <code>.DS_Store</code>, <code>Thumbs.db</code>, <code>composer.lock</code> and so on. You can modify <code>.gitignore</code> the way you wish, or simply copy this.</p>

<pre><code>/vendor
/node_modules
composer.phar
composer.lock
.env
.DS_Store
Thumbs.db
</code></pre>

<p>You pretty much understand what most of the ignored files are except for <code>.env</code>, which is newly introduced in Laravel 5.0 as an attempt to simplify the configuration of the confusing development environment back in Laravel 4.2.</p>

<p>In your local environment, you can simply put your database setting into <code>.env</code>. I specifically added the <code>DB_PORT</code> setting because we need it to get it on Openshift.</p>

<pre><code>APP_ENV=local
APP_DEBUG=true
APP_KEY=use_artisan_key:generate_to_gen_this

DB_HOST=MYSQL_DB_HOST
DB_DATABASE=MYSQL_DB_NAME
DB_USERNAME=MYSQL_DB_USERNAME
DB_PASSWORD=MYSQL_DB_PASSWORD
DB_PORT=MYSQL_DB_PORT

CACHE_DRIVER=file
SESSION_DRIVER=file
</code></pre>

<p>Look at my <code>config/database.php</code> you will see how the setting in <code>.env</code> are used. Like <a href="http://blog.tommyku.com/blog/database-config-trick-hosting-laravel-on-openshift">before</a> we try to get environmental variables from Openshift. The function <code>env('DB_HOST', 'default')</code> will take either <code>DB_HOST</code> from <code>.env</code> or use the default value in the second parameter. Since <code>.env</code> is excluded from version control, Laravel will take the Openshift-specific settings instead.</p>

<pre><code class="language-php">'mysql' =&gt; [
    'driver'    =&gt; 'mysql',
    'host'      =&gt; env('DB_HOST', getenv('OPENSHIFT_MYSQL_DB_HOST')),
    'database'  =&gt; env('DB_DATABASE', getenv('OPENSHIFT_APP_NAME')),
    'username'  =&gt; env('DB_USERNAME', getenv('OPENSHIFT_MYSQL_DB_USERNAME')),
    'password'  =&gt; env('DB_PASSWORD', getenv('OPENSHIFT_MYSQL_DB_PASSWORD')),
    'port'      =&gt; env('DB_PORT', getenv('OPENSHIFT_MYSQL_DB_PORT')),
    'charset'   =&gt; 'utf8',
    'collation' =&gt; 'utf8_unicode_ci',
    'prefix'    =&gt; '',
    'strict'    =&gt; false,
],
</code></pre>

<p>To test this, run (given that you have created the database locally)</p>

<pre><code class="language-bash">php artisan migrate
</code></pre>

<p><code>database/migrate</code> comes with two migrations by default which you can gracefully remove. The above command will do the migration for you as a simple test to database connectivity. For other database drivers it just work similary.</p>

<h4 id="pushing-to-openshift">Pushing to Openshift</h4>

<p>One thing that Laravel cannot use without is an action hook that loads Laravel dependencies on the remote end. See <code>.openshift/action_hooks/build</code>.</p>

<pre><code class="language-bash">#!/bin/bash

export COMPOSER_HOME="$OPENSHIFT_DATA_DIR/.composer"

if [ ! -f "$OPENSHIFT_DATA_DIR/composer.phar" ]; then
        echo 'Installing Composer'
        curl -s https://getcomposer.org/installer | php -- --quiet --install-dir=$OPENSHIFT_DATA_DIR
else
        echo 'Updating Composer'
        php $OPENSHIFT_DATA_DIR/composer.phar -q --no-ansi self-update
fi

if [ -d "$OPENSHIFT_REPO_DIR/vendor" ]; then
        echo 'Dependencies already installed, Moving on...'
else
        echo 'Hang in there, we are getting ready to Install/Update dependencies'
        echo 'Installing/Updating dependencies'; 
        unset GIT_DIR ; 
        cd $OPENSHIFT_REPO_DIR ; 
        php $OPENSHIFT_DATA_DIR/composer.phar -q --no-ansi install ;
fi
</code></pre>

<p>If this file does not exist in <code>.openshift/action_hooks/</code>, feel free to copy above bash script and create <code>build</code> file yourself. After doing so, remember to grant it the execution right by</p>

<pre><code class="language-bash">chmod +x build
</code></pre>

<p>You are taking one last step to push the application to Openshift, that is to add the remote to the version control.</p>

<pre><code class="language-bash">git init
git add --all
git commit -m 'Initial commit'
git remote add origin {link to the repo given by Openshift}
git push -uf origin master
</code></pre>

<p>Lastly, go checking out the site you have just pushed and see Laravel 5 running.</p>
</section><section id="suggestions"><h2>You could also look at...</h2><ul id="article-list"><li><a href="../database-config-trick-hosting-laravel-on-openshift/">Database config trick hosting Laravel on Openshift</a><p class="abstract">Setting environmental variables when running the application on OpenShift without changing the config for each deployment</p></li><li><a href="../persistent-env-configurations-across-deployments-on-openshift-for-laravel-5/">Persistent .env configurations across deployments on OpenShift for Laravel 5</a><p class="abstract">How I implemented persistent .env configuration on OpenShift v2 across deployments using OpenShift data directory and post-receive hook</p></li><li><a href="../create-simple-contact-list-application-with-laravel-and-openshift-integration-part-1/">Create simple contact list application with Laravel and Openshift integration: Part 1</a><p class="abstract">Part 1 of a 2-part tutorial about jump-starting a Laravel project on OpenShift, this part is about making a "Hello World" page</p></li></ul></section><p>This post first appeared on&nbsp;<a class="u-url" href="https://blog.tommyku.com/blog/setting-up-laravel-5-0-for-openshift/" id="permalink">Tommy Ku&#39;s blog</a>. Permalink: <a class="u-url" href="https://blog.tommyku.com/blog/setting-up-laravel-5-0-for-openshift/" id="permalink">https://blog.tommyku.com/blog/setting-up-laravel-5-0-for-openshift/</a></p><h2>About the author</h2><section class="h-card" id="bio"><img alt="Profile pic of Tommy Ku" class="u-photo" src="/assets/images/author.jpg" /><section class="p-note"><p><i><span class="p-author">Tommy Ku</span>, a&nbsp;<span class="p-country-name">Hong Kong</span>-based&nbsp;<span class="p-job-title">Software Engineer</span>&nbsp;experienced developing PHP and Java-based web solutions and passionate in Web technology.</i></p><p><i>Also a hobbyist digital and film photographer.</i></p></section></section></main><script src="/js/prism.js" type="text/javascript"></script><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://blog.tommyku.com/blog/setting-up-laravel-5-0-for-openshift/";
  this.page.identifier = "setting-up-laravel-5-0-for-openshift";
};

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = '//methodstub.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Please enable JavaScript to view the <a ,="" href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><hr /><footer></footer><a class="unloaded" href="https://blog.tommyku.com/blog/website-analytics-for-lazy-people" id="tracking-status" title="I know you viewed this page"></a><img onload="javascript: document.querySelector(&#39;#tracking-status&#39;).classList.replace(&#39;unloaded&#39;, &#39;loaded&#39;)" src="https://blog-view.tkcom.workers.dev/?https://blog.tommyku.com/blog/setting-up-laravel-5-0-for-openshift/" style="width: 0px; height: 0px; margin: 0; padding: 0; visibility: hidden;" /></body></html>