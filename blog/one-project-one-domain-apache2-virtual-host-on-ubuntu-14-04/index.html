<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0" name="viewport" /><meta content="One project, one domain: Apache2 Virtual Host on Ubuntu 14.04 - Tommy Ku&#39;s Blog - Random thoughts, stories and tutorials of a web dev" name="title" /><meta content="Web developer Tommy Ku talks about his experience in work, learning and life." name="description" /><meta content="Tommy Ku" name="author" /><meta content="One project, one domain: Apache2 Virtual Host on Ubuntu 14.04 - Tommy Ku&#39;s Blog - Random thoughts, stories and tutorials of a web dev" property="og:title" /><meta content="article" property="og:type" /><meta content="/assets/images/banner.jpg" property="og:image" /><link href="/assets/images/author.jpg" rel="icon" type="image/png" /><link href="/atom.xml" rel="alternate" title="Tommy Ku&#39;s Method Stub" type="application/atom+xml" /><link href="https://webmention.tkcom.workers.dev/" rel="webmention" /><title>One project, one domain: Apache2 Virtual Host on Ubuntu 14.04 - Tommy Ku&#39;s Blog</title><link href="/style/gutenberg.css" rel="stylesheet" /><link href="/style/prism.css" rel="stylesheet" /><meta content="Nanoc 4.11.15" name="generator" /></head><body><header><h2 class="h-card"><img alt="Profile pic of Tommy Ku" class="author u-photo" src="/assets/images/author.jpg" /><span class="p-name">Tommy Ku</span>'s Blog</h2><p><i>Reading and thinking</i></p></header><nav><a href="/">Index</a><a href="https://tommyku.com">About Me</a><a href="https://angel.co/tommyku">AngelList</a><a href="https://www.linkedin.com/in/tommy-chun-kit-ku-65aba999">LinkedIn</a><a rel="me" href="https://github.com/tommyku">GitHub</a><a href="/atom.xml">Feed</a></nav><main class="h-entry" id="main"><section id="meta"><h1 class="p-name">One project, one domain: Apache2 Virtual Host on Ubuntu 14.04</h1><i>Posted on&nbsp;<time class="dt-published" datetime="2015-01-20T00:00:00+08:00">January 20, 2015</time>&nbsp;by&nbsp;<span class="p-author">Tommy Ku</span></i><section id="old"><span class="icon">&#9888;</span><p>This post is more than 2 years old, it may contain outdated information</p></section></section><section class="e-content" id="content"><p>Sometimes I just want one domain + one server for each project in my local environment.</p>

<p>Be you a workaholic or not, you may be like me who have dozen of folders in your Apache server’s DocumentRoot. As time goes by, more and more projects get created and store in that particular folder and it starts to look messy. Oh, more than that, it tortues you whenever you run your app: <code>http://localhost/this-project</code>, <code>http://localhost/that-project</code>, or <code>http://localhost/stupidly-long-project-name</code>.</p>

<blockquote>
  <p><em>“With great power comes great responsibility.”</em>
<strong>Uncle Ben</strong></p>
</blockquote>

<p>The more the projects you have, the more you should organize them well with nice-looking URL free of <code>http://localhost</code>. <code>php artisan serve</code> (i.e. start another server from the app) solves half of the problem, as you may want to access any of your projects through port 80.</p>

<p>With virtual host on Apache2 web server it is possible to access your app from <code>http://this-project.lo</code> or <code>http://that-project.lo</code>, or <code>http://slpn.lo</code> (stupidly long project name) without changing any of the directory structure. This is called <a href="http://httpd.apache.org/docs/2.2/vhosts/name-based.html">Name-based Virtual Hosts</a>. As its name suggests, the server determines what you are requesting according to the hostname the client includes in HTTP header. Another way is IP-based Virtual Hosts, which you probably find it less favorable because you want to identify different sites by names, not IP.</p>

<blockquote>
  <p>For your information, virtual hosts is a way to get multiple websites running on the same server in web hosting company. But we are more excited about running multiple sites <em>locally</em> in this article.</p>
</blockquote>

<h4 id="the-settings">The settings</h4>

<p>Let there be a project located at DocumentRoot <code>/var/www/html/the-project</code>, and we want to access this project from <code>tp.lo</code>, meaning “the-project from localhost”.</p>

<blockquote>
  <p>.lo is to date not a valid Internet TLD. Don’t worry about using virtual host this way will fence off yourself from a proper website from the Internet</p>
</blockquote>

<p>We are forking the default settings of <code>localhost</code>.</p>

<pre><code class="language-bash">sudo cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/tp.lo.conf
</code></pre>

<p>Fire up a text editor and open <code>tp.lo.conf</code>. If you screw this step up, you can always copy <code>000-default.conf</code> again.</p>

<pre><code class="language-apache">&lt;VirtualHost *:80&gt;
	ServerName tp.lo
	DocumentRoot /var/www/html/the-project

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;
</code></pre>

<p>There are 2 things you want to modifty: <code>ServerName</code> and <code>DocumentRoot</code>. Modification to the port number <code>*:80</code> is very much optional. <code>ServerName</code> indicates the domain name you want to use, <code>tp.lo</code> in this example. <code>DocumentRoot</code> tells the web server where your website is, we already know the project is located at <code>/var/www/html/the-project</code> so fill that as is.</p>

<h4 id="bring-the-site-up">Bring the site up</h4>

<p>The setup is almost done but we need to notify the web server we have a new virtual host and tell the operating system where to look at with the domain name <code>tp.lo</code>, which is probably not listed in any DNS.</p>

<pre><code class="language-bash">sudo a2ensite /etc/apache2/sites-available/tp.lo.conf
sudo service apache2 restart
</code></pre>

<p>Now Apache2 knows about this virtual host thing. Next, append the following line to <code>/etc/hosts</code>.</p>

<pre><code>127.0.0.1    tp.lo
</code></pre>

<p>If you open a browser and go to <code>tp.lo</code>, you may be redirected to a search engine because the browser has not known about your virtural host yet. Go to <code>http://tp.lo</code> if that happens.</p>

<h4 id="bring-it-down">Bring it down</h4>

<p>Next time when you are done with the site and want to remove it, run</p>

<pre><code class="language-bash">sudo a2dissite /etc/apache2/sites-available/tp.lo.conf
sudo service apache2 restart
</code></pre>
</section><section id="suggestions"><h2>You could also look at...</h2><ul id="article-list"><li><a href="../a-self-hosting-lifecycle/">A self-hosting lifecycle</a><p class="abstract">How is it like to self-host something? This post describes the process of self-hosting from the initial thought process, to patching and housekeeping, all the way to the end-of-life of a self-hosted service</p></li><li><a href="../hide-docker-containers-behind-nginx-proxy/">Hide Docker containers behind Nginx proxy</a><p class="abstract">How I ditched VPN and embrace basica HTTP authentication when I am too lazy to implement user authentication into individual app</p></li><li><a href="../relocating-from-openshift-v2/">Relocating from OpenShift v2</a><p class="abstract">Documenting how I migrated my sites to other hosts at minimal cost as the free hosting platform OpenShift v2 I have been using will be closed down soon</p></li></ul></section><p>This post first appeared on&nbsp;<a class="u-url" href="https://blog.tommyku.com/blog/one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04/" id="permalink">Tommy Ku&#39;s blog</a>. Permalink: <a class="u-url" href="https://blog.tommyku.com/blog/one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04/" id="permalink">https://blog.tommyku.com/blog/one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04/</a></p><h2>About the author</h2><section class="h-card" id="bio"><img alt="Profile pic of Tommy Ku" class="u-photo" src="/assets/images/author.jpg" /><section class="p-note"><p><i><span class="p-author">Tommy Ku</span>, a&nbsp;<span class="p-country-name">Hong Kong</span>-based&nbsp;<span class="p-job-title">Software Engineer</span>&nbsp;experienced developing PHP and Java-based web solutions and passionate in Web technology.</i></p><p><i>Also a hobbyist digital and film photographer.</i></p></section></section></main><script src="/js/prism.js" type="text/javascript"></script><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://blog.tommyku.com/blog/one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04/";
  this.page.identifier = "one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04";
};

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = '//methodstub.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Please enable JavaScript to view the <a ,="" href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><hr /><footer></footer><a class="unloaded" href="https://blog.tommyku.com/blog/website-analytics-for-lazy-people" id="tracking-status" title="I know you viewed this page"></a><img onload="javascript: document.querySelector(&#39;#tracking-status&#39;).classList.replace(&#39;unloaded&#39;, &#39;loaded&#39;)" src="https://blog-view.tkcom.workers.dev/?https://blog.tommyku.com/blog/one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04/" style="width: 0px; height: 0px; margin: 0; padding: 0; visibility: hidden;" /></body></html>