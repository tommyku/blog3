<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0" name="viewport" /><meta content="Database config trick hosting Laravel on Openshift - Tommy Ku&#39;s Blog - Random thoughts, stories and tutorials of a web dev" name="title" /><meta content="Web developer Tommy Ku talks about his experience in work, learning and life." name="description" /><meta content="Tommy Ku" name="author" /><meta content="Database config trick hosting Laravel on Openshift - Tommy Ku&#39;s Blog - Random thoughts, stories and tutorials of a web dev" property="og:title" /><meta content="article" property="og:type" /><meta content="/assets/images/banner.jpg" property="og:image" /><link href="/assets/images/author.jpg" rel="icon" type="image/png" /><link href="/atom.xml" rel="alternate" title="Tommy Ku&#39;s Method Stub" type="application/atom+xml" /><link href="https://webmention.tkcom.workers.dev/" rel="webmention" /><title>Database config trick hosting Laravel on Openshift - Tommy Ku&#39;s Blog</title><link href="/style/gutenberg.css" rel="stylesheet" /><link href="/style/prism.css" rel="stylesheet" /><meta content="Nanoc 4.11.15" name="generator" /></head><body><header><h2 class="h-card"><img alt="Profile pic of Tommy Ku" class="author u-photo" src="/assets/images/author.jpg" /><span class="p-name">Tommy Ku</span>'s Blog</h2><p><i>Reading and thinking</i></p></header><nav><a href="/">Index</a><a href="https://tommyku.com">About Me</a><a href="https://angel.co/tommyku">AngelList</a><a href="https://www.linkedin.com/in/tommy-chun-kit-ku-65aba999">LinkedIn</a><a rel="me" href="https://github.com/tommyku">GitHub</a><a href="/atom.xml">Feed</a></nav><main class="h-entry" id="main"><section id="meta"><h1 class="p-name">Database config trick hosting Laravel on Openshift</h1><i>Posted on&nbsp;<time class="dt-published" datetime="2014-10-22T00:00:00+08:00">October 22, 2014</time>&nbsp;by&nbsp;<span class="p-author">Tommy Ku</span></i><section id="old"><span class="icon">&#9888;</span><p>This post is more than 2 years old, it may contain outdated information</p></section></section><section class="e-content" id="content"><p>Most of the case when I develop using Laravel, I would first host the app locally, then push the changes to Openshift when all tests are done. One thing that bugs me is every time I push I forgot to modify the database settings to Openshift’s database setting. The app crashes until I notice it and I ended up pushing an additional commit that does nothing but “fix db setting”.</p>

<p>So here are the fool-proof tricks that saved me from the pain of useless re-pushing.</p>

<h4 id="the-easy-way">The easy way</h4>

<p>Use .gitignore</p>

<p>When you push the app onto Openshift for the first time, push with Openshift’s database setting.</p>

<pre><code>app/config/database.php
</code></pre>

<pre><code class="language-php">/* the rest of the code */
'mysql' =&gt; array(
  'driver'    =&gt; 'mysql',
  'host'      =&gt; getenv('OPENSHIFT_MYSQL_DB_HOST'),
  'port'      =&gt; getenv('OPENSHIFT_MYSQL_DB_PORT'),
  'database'  =&gt; getenv('OPENSHIFT_APP_NAME'),
  'username'  =&gt; getenv('OPENSHIFT_MYSQL_DB_USERNAME'),
  'password'  =&gt; getenv('OPENSHIFT_MYSQL_DB_PASSWORD'),
  'charset'   =&gt; 'utf8',
  'collation' =&gt; 'utf8_unicode_ci',
  'prefix'    =&gt; '',
),
/* the rest of the code */
</code></pre>

<p>Then make yourself a .gitigore, or modify the existing one.</p>

<pre><code>.gitignore
</code></pre>

<pre><code class="language-bash">/bootstrap/compiled.php
/vendor
composer.phar
composer.lock
.env.*.php
.env.php
.DS_Store
Thumbs.db
/app/config/database.php
</code></pre>

<p>.gitignore guraranttes the enlisted files be ignored in git commit and git push, thus you can modify <code>database.php</code> to your local setting as much as you like. Next time you push, what stays on Openshift will be the <code>database.php</code> you originally pushed.</p>

<h4 id="another-way-for-your-interest">Another way for your interest</h4>

<p>In case your database setting cannot be separated from your code (uncommon, but possible), you can write down settings of both sides anyway. Openshift’s database settings are stored in environmental variable, which are not set in local environment. Since <a href="http://php.net/manual/en/function.getenv.php">getenv()</a> returns false when the requested variable does not exist, we can just fallback to local setting when the function returns false.</p>

<p>This is done using ternary if.</p>

<pre><code>app/config/database.php
</code></pre>

<pre><code class="language-php">/* the rest of the code */
'mysql' =&gt; array(
  'driver'    =&gt; 'mysql',
  'host'      =&gt; (getenv('OPENSHIFT_MYSQL_DB_HOST')) ? getenv('OPENSHIFT_MYSQL_DB_HOST') : 'LOCAL_MYSQL_HOST',
  'port'      =&gt; (getenv('OPENSHIFT_MYSQL_DB_PORT')) ? getenv('OPENSHIFT_MYSQL_DB_PORT') : LOCAL_MYSQL_PORT,
  'database'  =&gt; (getenv('OPENSHIFT_APP_NAME')) ? getenv('OPENSHIFT_APP_NAME') : 'LOCAL_MYSQL_DATABASE',
  'username'  =&gt; (getenv('OPENSHIFT_MYSQL_DB_USERNAME')) ? getenv('OPENSHIFT_MYSQL_DB_USERNAME') : 'LOCAL_MYSQL_USERNAME',
  'password'  =&gt; (getenv('OPENSHIFT_MYSQL_DB_PASSWORD')) ? getenv('OPENSHIFT_MYSQL_DB_PASSWORD') : 'LOCAL_MYSQL_PASSWORD',
  'charset'   =&gt; 'utf8',
  'collation' =&gt; 'utf8_unicode_ci',
  'prefix'    =&gt; '',
),
/* the rest of the code */
</code></pre>

<p>There may be some better solutions to this, drop some lines into the comment box if you do!</p>

</section><section id="suggestions"><h2>You could also look at...</h2><ul id="article-list"><li><a href="../setting-up-laravel-5-0-for-openshift/">Setting up Laravel 5.0 for Openshift</a><p class="abstract">A guide to setting up Laravel 5.0 on OpenShift v2.0 platform and using the environmental variables provided by OpenShift v2.0</p></li><li><a href="../an-artisan-command-for-using-multiple-environment-configurations-in-laravel-5/">An artisan command for using multiple environment configurations in Laravel 5</a><p class="abstract">I developed an artisan command to switch between Laravel 5 environmental configurations</p></li><li><a href="../create-simple-contact-list-application-with-laravel-and-openshift-integration-part-1/">Create simple contact list application with Laravel and Openshift integration: Part 1</a><p class="abstract">Part 1 of a 2-part tutorial about jump-starting a Laravel project on OpenShift, this part is about making a "Hello World" page</p></li></ul></section><p>This post first appeared on&nbsp;<a class="u-url" href="https://blog.tommyku.com/blog/database-config-trick-hosting-laravel-on-openshift/" id="permalink">Tommy Ku&#39;s blog</a>. Permalink: <a class="u-url" href="https://blog.tommyku.com/blog/database-config-trick-hosting-laravel-on-openshift/" id="permalink">https://blog.tommyku.com/blog/database-config-trick-hosting-laravel-on-openshift/</a></p><h2>About the author</h2><section class="h-card" id="bio"><img alt="Profile pic of Tommy Ku" class="u-photo" src="/assets/images/author.jpg" /><section class="p-note"><p><i><span class="p-author">Tommy Ku</span>, a&nbsp;<span class="p-country-name">Hong Kong</span>-based&nbsp;<span class="p-job-title">Software Engineer</span>&nbsp;experienced developing PHP and Java-based web solutions and passionate in Web technology.</i></p><p><i>Also a hobbyist digital and film photographer.</i></p></section></section></main><script src="/js/prism.js" type="text/javascript"></script><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://blog.tommyku.com/blog/database-config-trick-hosting-laravel-on-openshift/";
  this.page.identifier = "database-config-trick-hosting-laravel-on-openshift";
};

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = '//methodstub.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Please enable JavaScript to view the <a ,="" href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><hr /><footer></footer><a class="unloaded" href="https://blog.tommyku.com/blog/website-analytics-for-lazy-people" id="tracking-status" title="I know you viewed this page"></a><img onload="javascript: document.querySelector(&#39;#tracking-status&#39;).classList.replace(&#39;unloaded&#39;, &#39;loaded&#39;)" src="https://blog-view.tkcom.workers.dev/?https://blog.tommyku.com/blog/database-config-trick-hosting-laravel-on-openshift/" style="width: 0px; height: 0px; margin: 0; padding: 0; visibility: hidden;" /></body></html>